name: Test ARC Runner

on:
  workflow_dispatch:
  push:
    branches: [main, master]
    paths:
      - '.github/workflows/test-runner.yml'

jobs:
  test:
    name: Testar Runner ARC
    runs-on: github-runner-set
    
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      
      - name: InformaÃ§Ãµes do ambiente
        run: |
          echo "ðŸ–¥ï¸ Sistema Operacional:"
          cat /etc/os-release | grep -E "^(NAME|VERSION)="
          
          echo ""
          echo "â˜• Java:"
          java -version
          
          echo ""
          echo "ðŸ“¦ Maven:"
          mvn -version
          
          echo ""
          echo "ðŸ³ Docker:"
          docker --version
          
          echo ""
          echo "ðŸ’¾ EspaÃ§o em disco:"
          df -h
          
          echo ""
          echo "ðŸ§  MemÃ³ria:"
          free -h
      
      - name: Testar Docker
        run: |
          echo "ðŸ³ Testando Docker..."
          docker run --rm hello-world
          echo "âœ… Docker funcionando!"
      
      - name: Testar build Docker
        run: |
          echo "ðŸ”¨ Testando build de uma imagem simples..."
          
          # Criar Dockerfile de teste
          cat > /tmp/Dockerfile <<EOF
          FROM alpine:latest
          RUN echo "Hello from ARC Runner!"
          CMD ["echo", "Build successful!"]
          EOF
          
          # Build
          docker build -t test-image:latest /tmp/
          
          # Executar
          docker run --rm test-image:latest
          
          echo "âœ… Build Docker funcionando!"
      
      - name: Resumo
        run: |
          echo "## âœ… Teste do Runner ARC" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "O runner estÃ¡ funcionando corretamente!" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### Ferramentas disponÃ­veis:" >> $GITHUB_STEP_SUMMARY
          echo "- â˜• Java 21" >> $GITHUB_STEP_SUMMARY
          echo "- ðŸ“¦ Maven 3.9" >> $GITHUB_STEP_SUMMARY
          echo "- ðŸ³ Docker" >> $GITHUB_STEP_SUMMARY
          echo "- ðŸ Python 3" >> $GITHUB_STEP_SUMMARY
